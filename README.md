# idserver
分布式唯一ID生成器，基于MySQL号段原理。一次性从MySQL中申请10000个ID（使用乐观锁），其余操作在内存中进行。
## 问题探讨
- 可用性保证：使用etcd选主，全程只有主节点对外服务。主节点宕机后，重新选主。从节点每秒钟中MySQL中读取到最近操作过的数据，提前预热。选主后能直接对外服务。（读取间隔，预热的条数）
- 为什么使用主从结构，而不是集群：集群模式下，需要将同一个tag的请求负载均衡到一个节点上，否则会出现乱序问题。（请求MySQL号段时，使用锁，保证一个号段只会被一个节点持有。请求随机打到不同节点，拿到的ID会出现乱序问题。）
- id有序性：只有一个节点对外服务，不会出现乱序。重启后，重新申请号段，会有部分id浪费，但不会出现重复。
## 参考
[Leaf——美团点评分布式ID生成系统 - 美团技术团队 (meituan.com)](https://tech.meituan.com/2017/04/21/mt-leaf.html)


```shell
# 生成可执行文件
go build -o "ideserver"
```